# 并发篇
## 1、JDK
### 1.1 synchronized
* 具体实现
  * 同步方法
    * 在同步方法中加上了ACC_SYNCHRONZED标志
  * 同步代码块
    * 在代码块的前后加上了monitorenter和monitorexit指令实现
* 如何保障互斥（谈到互斥都是重量级锁，也就都是由操作系统来负责）
  * monitor监视对象来对锁的对象进行监视
    * 任何获取该对象控制权的对象都要经过监视对象的许可
      * 有队列来存储获取锁的线程
      * 有计数器，标识重入
* 锁升级过程
  * 默认无锁
  * 有线程获取，则设置成偏心
  * 有线程竞争，升级成轻量级锁
  * 线程增多，阻塞等待变多，升级成重量级锁
* 锁优化
  * 锁升级-->自旋+CAS
  * 锁消除-->JIT优化会做判断，判断锁住的代码是否只有一个线程，如果有则会对锁消除
  * 锁粗化-->循环内重复对一个对象上锁解锁，会讲锁的流程放在外面
### 1.2 volatile
* 可见性保障
  * JVM会对volatile修饰变量的变化指令加一个lock前缀的指令，用于标识这个指令要写回主存
* 有序性保障
  * 涉及到volatile修饰的变量，在其操作前后会增加一些内屏屏障，保障其变化不会乱序
* 优势
  * 没有锁竞争，比较轻量
### 1.3 AQS
### 